name: Autograding

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  test-html:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        
    - name: Install dependencies
      run: |
        npm install -g html-validator
        npm install -g jsdom
        
    - name: Test ejercicio1.html
      run: |
        # Verificar que el archivo existe y tiene contenido
        if [ ! -f "ejercicio1.html" ]; then
          echo "‚ùå ejercicio1.html no existe"
          exit 1
        fi
        
        # Verificar estructura b√°sica
        if ! grep -q "¬°Texto actualizado con Javascript!" ejercicio1.html; then
          echo "‚ùå ejercicio1.html no contiene el texto requerido"
          exit 1
        fi
        
        if ! grep -q "onclick" ejercicio1.html; then
          echo "‚ùå ejercicio1.html no tiene evento onclick"
          exit 1
        fi
        
        echo "‚úÖ ejercicio1.html pasa las pruebas b√°sicas"
        
    - name: Test ejercicio2.html
      run: |
        # Verificar que el archivo existe
        if [ ! -f "ejercicio2.html" ]; then
          echo "‚ùå ejercicio2.html no existe"
          exit 1
        fi
        
        # Verificar estructura b√°sica
        if ! grep -q "Demostraci√≥n de Output en Javascript" ejercicio2.html; then
          echo "‚ùå ejercicio2.html no tiene el t√≠tulo requerido"
          exit 1
        fi
        
        if ! grep -q "Adrian Flores" ejercicio2.html; then
          echo "‚ùå ejercicio2.html no tiene tu nombre en la alerta"
          exit 1
        fi
        
        if ! grep -q "Texto actualizado con Javascript!" ejercicio2.html; then
          echo "‚ùå ejercicio2.html no contiene el texto de actualizaci√≥n"
          exit 1
        fi
        
        echo "‚úÖ ejercicio2.html pasa las pruebas b√°sicas"
        
    - name: Final validation
      run: |
        echo "üéâ Todos los ejercicios pasaron las validaciones b√°sicas"
        echo "Los archivos HTML tienen la estructura correcta"
